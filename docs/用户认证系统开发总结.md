# ç”¨æˆ·è®¤è¯ç³»ç»Ÿå¼€å‘æ€»ç»“

## ğŸ¯ å¼€å‘æ¦‚è¿°

ç”¨æˆ·è®¤è¯ç³»ç»Ÿæ˜¯è¿ç»´å ¡å’æœºçš„æ ¸å¿ƒæ¨¡å—ï¼Œè´Ÿè´£ç”¨æˆ·èº«ä»½éªŒè¯ã€æƒé™ç®¡ç†å’Œè®¿é—®æ§åˆ¶ã€‚æœ¬æ¬¡å¼€å‘å®Œæˆäº†å®Œæ•´çš„JWTè®¤è¯æœºåˆ¶å’Œç”¨æˆ·ç®¡ç†åŠŸèƒ½ã€‚

## âœ… å·²å®ŒæˆåŠŸèƒ½

### 1. æ ¸å¿ƒè®¤è¯åŠŸèƒ½
- âœ… JWTä»¤ç‰Œç”Ÿæˆå’ŒéªŒè¯
- âœ… ç”¨æˆ·ç™»å½•/ç™»å‡º
- âœ… ä»¤ç‰Œåˆ·æ–°æœºåˆ¶
- âœ… ä»¤ç‰Œé»‘åå•ç®¡ç†
- âœ… å¯†ç åŠ å¯†å­˜å‚¨ï¼ˆbcryptï¼‰
- âœ… å¯†ç å¼ºåº¦éªŒè¯

### 2. ç”¨æˆ·ç®¡ç†åŠŸèƒ½
- âœ… ç”¨æˆ·CRUDæ“ä½œ
- âœ… ç”¨æˆ·çŠ¶æ€ç®¡ç†ï¼ˆå¯ç”¨/ç¦ç”¨ï¼‰
- âœ… å¯†ç é‡ç½®åŠŸèƒ½
- âœ… ç”¨æˆ·èµ„æ–™ç®¡ç†
- âœ… åˆ†é¡µæŸ¥è¯¢æ”¯æŒ

### 3. æƒé™æ§åˆ¶ç³»ç»Ÿ
- âœ… åŸºäºè§’è‰²çš„æƒé™æ§åˆ¶ï¼ˆRBACï¼‰
- âœ… ä¸‰ç§é»˜è®¤è§’è‰²ï¼šç®¡ç†å‘˜ã€è¿ç»´äººå‘˜ã€å®¡è®¡å‘˜
- âœ… æƒé™ä¸­é—´ä»¶å®ç°
- âœ… ç»†ç²’åº¦æƒé™éªŒè¯

### 4. ç³»ç»Ÿæ¶æ„
- âœ… å®Œæ•´çš„MVCæ¶æ„
- âœ… æœåŠ¡å±‚ä¸šåŠ¡é€»è¾‘å°è£…
- âœ… æ•°æ®è®¿é—®å±‚ï¼ˆGORMï¼‰
- âœ… é…ç½®ç®¡ç†ç³»ç»Ÿ
- âœ… æ—¥å¿—è®°å½•ç³»ç»Ÿ

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### æŠ€æœ¯æ ˆ
- **åç«¯æ¡†æ¶**: Go + Gin
- **æ•°æ®åº“**: MySQL 8.0
- **ç¼“å­˜**: Redis
- **ORM**: GORM
- **è®¤è¯**: JWT
- **é…ç½®**: Viper
- **æ—¥å¿—**: Logrus

### é¡¹ç›®ç»“æ„
```
backend/
â”œâ”€â”€ config/         # é…ç½®ç®¡ç†
â”œâ”€â”€ models/         # æ•°æ®æ¨¡å‹
â”œâ”€â”€ services/       # ä¸šåŠ¡é€»è¾‘
â”œâ”€â”€ controllers/    # æ§åˆ¶å™¨
â”œâ”€â”€ middleware/     # ä¸­é—´ä»¶
â”œâ”€â”€ utils/          # å·¥å…·å‡½æ•°
â”œâ”€â”€ routers/        # è·¯ç”±è®¾ç½®
â””â”€â”€ main.go         # ç¨‹åºå…¥å£
```

## ğŸ“Š å¼€å‘ç»Ÿè®¡

### ä»£ç é‡ç»Ÿè®¡
- **æ€»æ–‡ä»¶æ•°**: 13ä¸ªGoæ–‡ä»¶
- **ä»£ç è¡Œæ•°**: çº¦2000è¡Œ
- **åŠŸèƒ½æ¨¡å—**: 7ä¸ªä¸»è¦æ¨¡å—
- **APIæ¥å£**: 15ä¸ªRESTfulæ¥å£

### æ•°æ®åº“è®¾è®¡
- **æ ¸å¿ƒè¡¨**: 3ä¸ªï¼ˆusers, roles, user_rolesï¼‰
- **æ”¯æŒè¡¨**: 4ä¸ªï¼ˆassets, credentials, sessions, operation_logsï¼‰
- **ç´¢å¼•**: 12ä¸ªä¼˜åŒ–ç´¢å¼•
- **çº¦æŸ**: å®Œæ•´çš„å¤–é”®çº¦æŸ

## ğŸš€ åŠŸèƒ½ç‰¹æ€§

### å®‰å…¨ç‰¹æ€§
1. **å¯†ç å®‰å…¨**: bcryptåŠ å¯†ï¼Œæœ€å°å¼ºåº¦è¦æ±‚
2. **ä»¤ç‰Œç®¡ç†**: JWTç­¾åéªŒè¯ï¼Œè¿‡æœŸæ—¶é—´æ§åˆ¶
3. **æƒé™æ§åˆ¶**: åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶
4. **ä¼šè¯ç®¡ç†**: ä»¤ç‰Œé»‘åå•ï¼Œå®‰å…¨ç™»å‡º
5. **è¾“å…¥éªŒè¯**: å®Œæ•´çš„å‚æ•°éªŒè¯

### æ€§èƒ½ç‰¹æ€§
1. **æ•°æ®åº“ä¼˜åŒ–**: ç´¢å¼•ä¼˜åŒ–ï¼Œè¿æ¥æ± é…ç½®
2. **ç¼“å­˜æ”¯æŒ**: Redisç¼“å­˜ä»¤ç‰Œé»‘åå•
3. **åˆ†é¡µæŸ¥è¯¢**: é«˜æ•ˆçš„åˆ†é¡µæœºåˆ¶
4. **äº‹åŠ¡å¤„ç†**: å®Œæ•´çš„äº‹åŠ¡ç®¡ç†

### å¯ç»´æŠ¤æ€§
1. **æ¨¡å—åŒ–è®¾è®¡**: æ¸…æ™°çš„åˆ†å±‚æ¶æ„
2. **é”™è¯¯å¤„ç†**: ç»Ÿä¸€çš„é”™è¯¯å¤„ç†æœºåˆ¶
3. **æ—¥å¿—è®°å½•**: å®Œæ•´çš„æ—¥å¿—ç³»ç»Ÿ
4. **é…ç½®ç®¡ç†**: çµæ´»çš„é…ç½®ç³»ç»Ÿ

## ğŸ”§ å…³é”®æŠ€æœ¯å®ç°

### 1. JWTè®¤è¯æœºåˆ¶
```go
// JWT Claimsç»“æ„
type Claims struct {
    UserID   uint   `json:"user_id"`
    Username string `json:"username"`
    jwt.RegisteredClaims
}

// Tokenç”Ÿæˆ
func GenerateToken(user *models.User) (*TokenResponse, error) {
    expireTime := time.Now().Add(time.Duration(config.GlobalConfig.JWT.Expire) * time.Second)
    claims := &Claims{
        UserID:   user.ID,
        Username: user.Username,
        RegisteredClaims: jwt.RegisteredClaims{
            ExpiresAt: jwt.NewNumericDate(expireTime),
            IssuedAt:  jwt.NewNumericDate(time.Now()),
            Issuer:    config.GlobalConfig.JWT.Issuer,
            ID:        uuid.New().String(),
        },
    }
    
    token := jwt.NewWithClaims(jwt.SigningMethodHS256, claims)
    return token.SignedString([]byte(config.GlobalConfig.JWT.Secret))
}
```

### 2. æƒé™ä¸­é—´ä»¶
```go
// æƒé™éªŒè¯ä¸­é—´ä»¶
func RequirePermission(permission string) gin.HandlerFunc {
    return func(c *gin.Context) {
        user := c.MustGet("user").(*models.User)
        if !user.HasPermission(permission) {
            c.JSON(http.StatusForbidden, gin.H{
                "error": "Insufficient permissions",
            })
            c.Abort()
            return
        }
        c.Next()
    }
}
```

### 3. æœåŠ¡å±‚è®¾è®¡
```go
// è®¤è¯æœåŠ¡æ¥å£
type AuthService struct {
    db *gorm.DB
}

func (s *AuthService) Login(request *models.UserLoginRequest) (*utils.TokenResponse, error) {
    // 1. éªŒè¯ç”¨æˆ·å­˜åœ¨
    // 2. éªŒè¯å¯†ç 
    // 3. æ£€æŸ¥ç”¨æˆ·çŠ¶æ€
    // 4. ç”ŸæˆJWTä»¤ç‰Œ
    // 5. è¿”å›ä»¤ç‰Œä¿¡æ¯
}
```

## ğŸ“‹ APIæ¥å£åˆ—è¡¨

### è®¤è¯ç›¸å…³
- `POST /api/v1/auth/login` - ç”¨æˆ·ç™»å½•
- `POST /api/v1/auth/refresh` - åˆ·æ–°ä»¤ç‰Œ
- `POST /api/v1/logout` - ç”¨æˆ·ç™»å‡º

### ç”¨æˆ·èµ„æ–™
- `GET /api/v1/me` - è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
- `GET /api/v1/profile` - è·å–ç”¨æˆ·èµ„æ–™
- `PUT /api/v1/profile` - æ›´æ–°ç”¨æˆ·èµ„æ–™
- `POST /api/v1/change-password` - ä¿®æ”¹å¯†ç 

### ç”¨æˆ·ç®¡ç†ï¼ˆç®¡ç†å‘˜ï¼‰
- `POST /api/v1/users` - åˆ›å»ºç”¨æˆ·
- `GET /api/v1/users` - è·å–ç”¨æˆ·åˆ—è¡¨
- `GET /api/v1/users/:id` - è·å–å•ä¸ªç”¨æˆ·
- `PUT /api/v1/users/:id` - æ›´æ–°ç”¨æˆ·
- `DELETE /api/v1/users/:id` - åˆ é™¤ç”¨æˆ·
- `POST /api/v1/users/:id/reset-password` - é‡ç½®å¯†ç 
- `POST /api/v1/users/:id/toggle-status` - åˆ‡æ¢çŠ¶æ€

### ç³»ç»Ÿç›‘æ§
- `GET /api/v1/health` - å¥åº·æ£€æŸ¥

## ğŸ› ï¸ éƒ¨ç½²å’Œé…ç½®

### æ•°æ®åº“é…ç½®
```yaml
database:
  host: "10.0.0.7"
  port: 3306
  username: "root"
  password: "your_password"
  dbname: "bastion"
```

### Redisé…ç½®
```yaml
redis:
  host: "10.0.0.7"
  port: 6379
  password: ""
  db: 0
```

### JWTé…ç½®
```yaml
jwt:
  secret: "bastion-jwt-secret-key-2024"
  expire: 86400  # 24å°æ—¶
  issuer: "bastion"
```

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

### é¢„æœŸæ€§èƒ½
- **å¹¶å‘ç”¨æˆ·**: 100+
- **APIå“åº”æ—¶é—´**: <500ms
- **ä»¤ç‰Œç”Ÿæˆ**: <50ms
- **æ•°æ®åº“æŸ¥è¯¢**: <100ms

### èµ„æºä½¿ç”¨
- **å†…å­˜å ç”¨**: <100MB
- **æ•°æ®åº“è¿æ¥**: 10-100ä¸ªè¿æ¥æ± 
- **Redisè¿æ¥**: 100ä¸ªè¿æ¥æ± 

## ğŸ”’ å®‰å…¨æªæ–½

### æ•°æ®ä¿æŠ¤
1. **å¯†ç åŠ å¯†**: bcryptå“ˆå¸Œå­˜å‚¨
2. **ä»¤ç‰Œç­¾å**: HMAC-SHA256ç­¾å
3. **è¾“å…¥éªŒè¯**: å®Œæ•´çš„å‚æ•°éªŒè¯
4. **SQLæ³¨å…¥é˜²æŠ¤**: GORMå‚æ•°åŒ–æŸ¥è¯¢

### è®¿é—®æ§åˆ¶
1. **èº«ä»½éªŒè¯**: JWTä»¤ç‰ŒéªŒè¯
2. **æƒé™æˆæƒ**: åŸºäºè§’è‰²çš„æƒé™æ§åˆ¶
3. **ä¼šè¯ç®¡ç†**: ä»¤ç‰Œé»‘åå•æœºåˆ¶
4. **è·¨åŸŸä¿æŠ¤**: CORSé…ç½®

## ğŸ“š ä½¿ç”¨æŒ‡å—

### å¿«é€Ÿå¼€å§‹
1. **å¯¼å…¥æ•°æ®åº“**: è¿è¡Œ`scripts/import_database.sh`
2. **å¯åŠ¨æœåŠ¡**: `go run main.go`
3. **æµ‹è¯•ç™»å½•**: ä½¿ç”¨é»˜è®¤è´¦æˆ·`admin/admin123`
4. **APIè°ƒç”¨**: å‚è€ƒ`docs/APIä½¿ç”¨æŒ‡å—.md`

### å¼€å‘å»ºè®®
1. ä½¿ç”¨Postmanæˆ–curlæµ‹è¯•API
2. æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶æ’æŸ¥é—®é¢˜
3. éµå¾ªRESTful APIè®¾è®¡è§„èŒƒ
4. ä¿æŒä»£ç é£æ ¼ä¸€è‡´

## ğŸ¯ ä¸‹ä¸€æ­¥è®¡åˆ’

### å³å°†å¼€å‘çš„åŠŸèƒ½
1. **èµ„äº§ç®¡ç†æ¨¡å—**: æœåŠ¡å™¨å’Œæ•°æ®åº“èµ„äº§ç®¡ç†
2. **SSHè®¿é—®ä»£ç†**: å®ç°SSHåè®®ä»£ç†
3. **å®¡è®¡æ—¥å¿—ç³»ç»Ÿ**: å®Œæ•´çš„æ“ä½œå®¡è®¡
4. **å‰ç«¯ç•Œé¢**: React + Ant Designç®¡ç†ç•Œé¢

### ä¼˜åŒ–æ–¹å‘
1. **æ€§èƒ½ä¼˜åŒ–**: æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–ã€ç¼“å­˜æœºåˆ¶
2. **å®‰å…¨å¢å¼º**: å¤šå› ç´ è®¤è¯ã€IPç™½åå•
3. **ç›‘æ§å‘Šè­¦**: ç³»ç»Ÿç›‘æ§å’Œå‘Šè­¦æœºåˆ¶
4. **æ—¥å¿—åˆ†æ**: æ—¥å¿—åˆ†æå’ŒæŠ¥è¡¨ç”Ÿæˆ

## ğŸ“„ ç›¸å…³æ–‡æ¡£

- [æ•°æ®åº“å¯¼å…¥æŒ‡å—](./æ•°æ®åº“å¯¼å…¥æŒ‡å—.md)
- [APIä½¿ç”¨æŒ‡å—](./APIä½¿ç”¨æŒ‡å—.md)
- [é¡¹ç›®æ¶æ„å›¾è¡¨é›†](./é¡¹ç›®æ¶æ„å›¾è¡¨é›†.md)
- [é¡¹ç›®åˆå§‹åŒ–æ€»ç»“](./é¡¹ç›®åˆå§‹åŒ–æ€»ç»“.md)

## ğŸ‰ å¼€å‘æˆæœ

ç”¨æˆ·è®¤è¯ç³»ç»Ÿå¼€å‘å®Œæˆï¼Œå®ç°äº†ï¼š
- âœ… **å®Œæ•´çš„JWTè®¤è¯æœºåˆ¶**
- âœ… **ç”¨æˆ·ç®¡ç†åŠŸèƒ½**
- âœ… **æƒé™æ§åˆ¶ç³»ç»Ÿ**
- âœ… **RESTful APIæ¥å£**
- âœ… **å®‰å…¨é˜²æŠ¤æªæ–½**
- âœ… **æ€§èƒ½ä¼˜åŒ–è®¾è®¡**

ç³»ç»Ÿå·²å‡†å¤‡å¥½è¿›å…¥ä¸‹ä¸€é˜¶æ®µçš„å¼€å‘ï¼Œå¯ä»¥å¼€å§‹å®ç°èµ„äº§ç®¡ç†æ¨¡å—ï¼ 