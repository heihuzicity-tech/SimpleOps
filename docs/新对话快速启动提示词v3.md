# Bastion项目新对话启动提示词 v3.0

我正在开发企业级运维堡垒机系统Bastion，需要你帮助我实施拖拽式分组管理功能。

## 📊 项目现状快照
- **项目**: 企业级运维堡垒机 (91.8%完成，用户体验优化阶段)
- **技术栈**: Go 1.21 + Gin + React 18 + TypeScript + Ant Design + MySQL 8.0 + Redis
- **当前阶段**: 用户体验优化，重点实施拖拽式分组管理
- **工作目录**: /Users/skip/workspace/bastion

## ✅ 核心功能状态
**后端架构(100%完成)**: 服务分层、接口抽象、依赖注入已重构完成
**分组功能(95%完成)**: 分组API完整，左侧分组树显示真实数据，分组过滤正常
**会话管理(100%完成)**: Redis统一存储、WebSocket实时通信已实现
**审计系统(85%完成)**: 操作、命令、会话、登录审计核心功能就绪
**前端组件(80%完成)**: 组件复用率80%，重复代码减少75%

## 🎯 当前优先任务：拖拽式分组管理

### 📋 用户需求背景
- **问题**: 用户反馈当前分组管理（弹窗形式）操作繁琐
- **需求**: 希望类似文件夹管理的拖拽体验
- **目标**: 主机可以直接拖拽到分组，分组管理按钮移到合适位置

### 🛠️ 技术实施方案
- **拖拽库**: @dnd-kit/core (现代化、TypeScript支持好)
- **核心组件**: DndContext, useDraggable, useDroppable
- **涉及文件**: 
  - `frontend/src/pages/AssetsPage.tsx` (主机列表可拖拽)
  - `frontend/src/components/sessions/ResourceTree.tsx` (分组可接收)
- **API需求**: 需要新增批量移动资产到分组的接口

### 📋 详细实施计划
**完整计划**: 参考 `docs/拖拽式分组管理实施计划.md` (4-6天，分3个阶段)

**Phase 1 (2-3天)**: 基础拖拽功能
- 安装@dnd-kit/core，创建拖拽上下文
- 主机表格支持draggable，分组树支持droppable
- 基础拖拽逻辑和API集成

**Phase 2 (1-2天)**: 交互优化  
- 批量选择和拖拽，撤销功能
- 视觉反馈和动画效果

**Phase 3 (1天)**: 界面整合
- 分组管理按钮位置调整
- 全功能测试和优化

## 🔧 开发环境
```bash
# 启动服务
./manage.sh start

# 查看状态  
./manage.sh status

# 查看日志
./manage.sh logs [service]

# 前端开发
cd frontend && npm run dev
```

## 📚 关键文档位置
- **详细任务**: `docs/当前开发任务清单.md`
- **拖拽方案**: `docs/拖拽式分组管理实施计划.md` ⭐
- **开发计划**: `docs/后续开发计划.md`
- **项目评估**: `docs/项目重构评估总结.md`
- **API指南**: `docs/API使用指南.md`

## 🎨 设计要求
```
期望的界面布局:
主机分类                    [+ 新建分组] [管理分组]
├─ 📁 全部主机 (5)
├─ 📁 生产环境 (2)         [可拖入区域，hover高亮]
│  ├─ 💻 web-server-01    [可拖拽项目]
│  └─ 💻 app-server-01  
├─ 📁 测试环境 (1)         [可拖入区域，hover高亮]
└─ 📁 开发环境 (0)         [空状态，可拖入]

交互效果:
- 拖拽开始: 主机半透明，分组高亮可接收状态
- 悬停分组: 背景色变化，显示"释放以移动到此分组"
- 拖拽完成: 动画效果，数量更新，Toast提示
```

## 🚨 其他待处理任务
1. **SSH安全漏洞修复** (高危) - backend/services/ssh_service.go:156
2. **登录日志界面完善** (中优) - 创建LoginLogsTable组件  
3. **WebSocket超时控制** (中危) - 防止内存泄漏

## 💡 技术提醒
- 当前分组功能已完整，左侧分组树显示真实API数据
- 主机按分组过滤功能正常工作
- 分组CRUD操作API齐全，支持group_ids参数
- 需要保持现有功能稳定性，渐进式增强

请帮我开始实施拖拽式分组管理功能，从Phase 1的基础拖拽功能开始。

---
*最后更新: 2025-07-15 | 优先级: 用户体验优化 | 预计耗时: 4-6天*