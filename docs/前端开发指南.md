# å‰ç«¯å¼€å‘æŒ‡å—

## æ¦‚è¿°

è¿ç»´å ¡å’æœºå‰ç«¯ç³»ç»ŸåŸºäºReact 18 + TypeScriptæ„å»ºï¼Œé‡‡ç”¨ç°ä»£åŒ–çš„å‰ç«¯æŠ€æœ¯æ ˆï¼Œæä¾›ä¼ä¸šçº§çš„ç”¨æˆ·ç•Œé¢å’Œç”¨æˆ·ä½“éªŒã€‚

## æŠ€æœ¯æ ˆ

### æ ¸å¿ƒæŠ€æœ¯
- **React 18**: ç°ä»£åŒ–çš„å‰ç«¯æ¡†æ¶
- **TypeScript**: ç±»å‹å®‰å…¨çš„JavaScript
- **Ant Design**: ä¼ä¸šçº§UIç»„ä»¶åº“
- **Redux Toolkit**: çŠ¶æ€ç®¡ç†å’ŒAPIç¼“å­˜
- **React Router v6**: ç°ä»£åŒ–çš„è·¯ç”±ç³»ç»Ÿ
- **Axios**: HTTPå®¢æˆ·ç«¯

### å¼€å‘å·¥å…·
- **Vite**: å¿«é€Ÿçš„æ„å»ºå·¥å…·
- **ESLint**: ä»£ç è§„èŒƒæ£€æŸ¥
- **Prettier**: ä»£ç æ ¼å¼åŒ–
- **Jest**: å•å…ƒæµ‹è¯•æ¡†æ¶

## é¡¹ç›®ç»“æ„

```
frontend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/         # é€šç”¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ DashboardLayout.tsx   # ä¸»å¸ƒå±€ç»„ä»¶
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ pages/              # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ LoginPage.tsx         # ç™»å½•é¡µé¢
â”‚   â”‚   â”œâ”€â”€ UsersPage.tsx         # ç”¨æˆ·ç®¡ç†é¡µé¢
â”‚   â”‚   â”œâ”€â”€ AssetsPage.tsx        # èµ„äº§ç®¡ç†é¡µé¢
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ services/           # APIæœåŠ¡
â”‚   â”‚   â”œâ”€â”€ authAPI.ts            # è®¤è¯API
â”‚   â”‚   â”œâ”€â”€ userAPI.ts            # ç”¨æˆ·API
â”‚   â”‚   â”œâ”€â”€ assetAPI.ts           # èµ„äº§API
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ store/              # ReduxçŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ authSlice.ts          # è®¤è¯çŠ¶æ€
â”‚   â”‚   â”œâ”€â”€ userSlice.ts          # ç”¨æˆ·çŠ¶æ€
â”‚   â”‚   â”œâ”€â”€ assetSlice.ts         # èµ„äº§çŠ¶æ€
â”‚   â”‚   â””â”€â”€ store.ts              # Storeé…ç½®
â”‚   â”œâ”€â”€ types/              # TypeScriptç±»å‹å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ auth.ts               # è®¤è¯ç›¸å…³ç±»å‹
â”‚   â”‚   â”œâ”€â”€ user.ts               # ç”¨æˆ·ç›¸å…³ç±»å‹
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ utils/              # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ request.ts            # HTTPè¯·æ±‚é…ç½®
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ App.tsx             # åº”ç”¨æ ¹ç»„ä»¶
â”‚   â””â”€â”€ main.tsx            # åº”ç”¨å…¥å£
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â””â”€â”€ vite.config.ts
```

## å·²å®ŒæˆåŠŸèƒ½

### 1. ç”¨æˆ·è®¤è¯ç³»ç»Ÿ âœ…
- **ç™»å½•ç•Œé¢**: å“åº”å¼ç™»å½•è¡¨å•ï¼Œæ”¯æŒç”¨æˆ·å/å¯†ç è®¤è¯
- **JWTè®¤è¯**: è‡ªåŠ¨Tokenç®¡ç†å’Œåˆ·æ–°
- **ç™»å½•çŠ¶æ€**: ç™»å½•çŠ¶æ€æŒä¹…åŒ–å’Œè‡ªåŠ¨æ¢å¤
- **é€€å‡ºç™»å½•**: å®‰å…¨çš„ç™»å‡ºæµç¨‹

### 2. å¸ƒå±€ç³»ç»Ÿ âœ…
- **å“åº”å¼å¸ƒå±€**: é€‚é…ä¸åŒå±å¹•å°ºå¯¸çš„ç®¡ç†åå°å¸ƒå±€
- **å¯¼èˆªèœå•**: ä¾§è¾¹æ å¯¼èˆªèœå•ï¼Œæ”¯æŒå›¾æ ‡å’Œè·¯ç”±
- **å¤´éƒ¨å¯¼èˆª**: ç”¨æˆ·ä¿¡æ¯ã€é€€å‡ºç™»å½•ç­‰åŠŸèƒ½
- **é¢åŒ…å±‘å¯¼èˆª**: è‡ªåŠ¨ç”Ÿæˆçš„é¢åŒ…å±‘å¯¼èˆª

### 3. ç”¨æˆ·ç®¡ç† âœ…
- **ç”¨æˆ·åˆ—è¡¨**: åˆ†é¡µæ˜¾ç¤ºç”¨æˆ·åˆ—è¡¨ï¼Œæ”¯æŒæœç´¢å’Œç­›é€‰
- **ç”¨æˆ·åˆ›å»º**: è¡¨å•éªŒè¯çš„ç”¨æˆ·åˆ›å»ºåŠŸèƒ½
- **ç”¨æˆ·ç¼–è¾‘**: è¡Œå†…ç¼–è¾‘å’Œå¼¹æ¡†ç¼–è¾‘æ”¯æŒ
- **ç”¨æˆ·åˆ é™¤**: è½¯åˆ é™¤åŠŸèƒ½
- **çŠ¶æ€ç®¡ç†**: ç”¨æˆ·çŠ¶æ€åˆ‡æ¢ï¼ˆå¯ç”¨/ç¦ç”¨ï¼‰

### 4. èµ„äº§ç®¡ç† âœ…
- **èµ„äº§åˆ—è¡¨**: åˆ†é¡µæ˜¾ç¤ºèµ„äº§åˆ—è¡¨
- **èµ„äº§åˆ›å»º**: æ”¯æŒå¤šç§èµ„äº§ç±»å‹çš„åˆ›å»º
- **èµ„äº§ç¼–è¾‘**: å®Œæ•´çš„èµ„äº§ä¿¡æ¯ç¼–è¾‘
- **èµ„äº§åˆ é™¤**: è½¯åˆ é™¤åŠŸèƒ½
- **è¿æ¥æµ‹è¯•**: èµ„äº§è¿æ¥çŠ¶æ€æµ‹è¯•

### 5. æƒé™ç³»ç»Ÿ âœ…
- **åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶**: å®Œæ•´çš„RBACæƒé™ç³»ç»Ÿ
- **åŠ¨æ€èœå•**: æ ¹æ®ç”¨æˆ·è§’è‰²åŠ¨æ€æ˜¾ç¤ºèœå•é¡¹
- **é¡µé¢ä¿æŠ¤**: PermissionGuardç»„ä»¶ä¿æŠ¤éœ€è¦ç‰¹å®šæƒé™çš„é¡µé¢
- **æƒé™å·¥å…·**: ç»Ÿä¸€çš„æƒé™æ£€æŸ¥å·¥å…·å‡½æ•°
- **å‹å¥½æç¤º**: 403æƒé™ä¸è¶³é¡µé¢ï¼Œå¼•å¯¼ç”¨æˆ·è¿”å›

#### 5.1 æƒé™æ£€æŸ¥å·¥å…·å‡½æ•°
```typescript
// utils/permissions.ts
export const hasAdminPermission = (user: User | null): boolean => {
  if (!user || !user.roles) return false;
  return user.roles.some(role => role.name === 'admin');
};

export const hasOperatorPermission = (user: User | null): boolean => {
  if (!user || !user.roles) return false;
  return user.roles.some(role => 
    role.name === 'admin' || role.name === 'operator'
  );
};

export const hasAnyRole = (user: User | null, roleNames: string[]): boolean => {
  if (!user || !user.roles) return false;
  return roleNames.some(roleName => 
    user.roles.some(role => role.name === roleName)
  );
};
```

#### 5.2 é¡µé¢æƒé™ä¿æŠ¤
```typescript
// åœ¨App.tsxä¸­ä½¿ç”¨PermissionGuardä¿æŠ¤è·¯ç”±
<Route 
  path="/users" 
  element={
    <PermissionGuard requiredRole="admin">
      <UsersPage />
    </PermissionGuard>
  } 
/>

<Route 
  path="/assets" 
  element={
    <PermissionGuard requiredRole={['admin', 'operator']}>
      <AssetsPage />
    </PermissionGuard>
  } 
/>
```

#### 5.3 åŠ¨æ€èœå•æ§åˆ¶
```typescript
// åœ¨DashboardLayoutä¸­æ ¹æ®æƒé™åŠ¨æ€ç”Ÿæˆèœå•
const getMenuItems = () => {
  const items = [{ key: '/dashboard', icon: <DashboardOutlined />, label: 'ä»ªè¡¨æ¿' }];
  
  // ç®¡ç†å‘˜åŠŸèƒ½
  if (hasAdminPermission(user)) {
    items.push({ key: '/users', icon: <UserOutlined />, label: 'ç”¨æˆ·ç®¡ç†' });
  }
  
  // è¿ç»´äººå‘˜å’Œç®¡ç†å‘˜åŠŸèƒ½
  if (hasOperatorPermission(user)) {
    items.push(
      { key: '/assets', icon: <DesktopOutlined />, label: 'èµ„äº§ç®¡ç†' },
      { key: '/ssh-sessions', icon: <ConsoleSqlOutlined />, label: 'SSHä¼šè¯' }
    );
  }
  
  return items;
};
```

## æ•°æ®æµæ¶æ„

### APIé›†æˆ
```typescript
// APIæœåŠ¡å±‚
export const authAPI = {
  login: (credentials: LoginCredentials) => request.post('/auth/login', credentials),
  logout: () => request.post('/logout'),
  getProfile: () => request.get('/profile'),
  changePassword: (data: ChangePasswordData) => request.post('/change-password', data)
};

// Redux Slice
export const authSlice = createSlice({
  name: 'auth',
  initialState,
  reducers: {
    // åŒæ­¥actions
  },
  extraReducers: (builder) => {
    builder
      .addCase(loginAsync.fulfilled, (state, action) => {
        state.isAuthenticated = true;
        state.user = action.payload.user;
        state.token = action.payload.token;
      })
      // å…¶ä»–å¼‚æ­¥actions
  }
});
```

### çŠ¶æ€ç®¡ç†
- **è®¤è¯çŠ¶æ€**: ç”¨æˆ·ç™»å½•çŠ¶æ€ã€ç”¨æˆ·ä¿¡æ¯ã€Tokenç®¡ç†
- **ç”¨æˆ·çŠ¶æ€**: ç”¨æˆ·åˆ—è¡¨ã€è§’è‰²åˆ—è¡¨ã€æƒé™ä¿¡æ¯
- **èµ„äº§çŠ¶æ€**: èµ„äº§åˆ—è¡¨ã€å‡­è¯ä¿¡æ¯ã€è¿æ¥çŠ¶æ€
- **UIçŠ¶æ€**: åŠ è½½çŠ¶æ€ã€é”™è¯¯ä¿¡æ¯ã€è¡¨å•çŠ¶æ€

## å¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆ

### 1. React Routerå‡çº§é—®é¢˜
**é—®é¢˜**: React Router v6åºŸå¼ƒè­¦å‘Š
**è§£å†³æ–¹æ¡ˆ**: æ·»åŠ future flagsé…ç½®
```typescript
// App.tsx
<BrowserRouter future={{ v7_relativeSplatPath: true, v7_startTransition: true }}>
  <Routes>
    <Route path="/*" element={<AppRoutes />} />
  </Routes>
</BrowserRouter>
```

### 2. å‰åç«¯æ•°æ®æ ¼å¼ä¸ä¸€è‡´
**é—®é¢˜**: åç«¯è¿”å›`{success: true, data: {...}}`æ ¼å¼ï¼Œå‰ç«¯æœŸæœ›ç›´æ¥çš„æ•°æ®
**è§£å†³æ–¹æ¡ˆ**: åœ¨APIå“åº”å¤„ç†ä¸­ç»Ÿä¸€æ•°æ®æ ¼å¼
```typescript
// userSlice.ts
.addCase(fetchUsers.fulfilled, (state, action) => {
  // å¤„ç†åç«¯è¿”å›çš„åµŒå¥—æ•°æ®æ ¼å¼
  if (action.payload.success && action.payload.data) {
    state.users = action.payload.data.users || [];
    state.roles = action.payload.data.roles || [];
  }
})
```

### 3. ç”¨æˆ·çŠ¶æ€æ•°æ®ç±»å‹ä¸åŒ¹é…
**é—®é¢˜**: å‰ç«¯å‘é€å­—ç¬¦ä¸²çŠ¶æ€ï¼Œåç«¯æœŸæœ›æ•°å­—çŠ¶æ€
**è§£å†³æ–¹æ¡ˆ**: åœ¨æäº¤å‰è¿›è¡Œæ•°æ®è½¬æ¢
```typescript
// æäº¤æ—¶è½¬æ¢çŠ¶æ€æ ¼å¼
const submitData = {
  ...values,
  status: values.status === 'active' ? 1 : 0
};
```

### 4. å›¾æ ‡å¯¼å…¥é”™è¯¯
**é—®é¢˜**: å¯¼å…¥ä¸å­˜åœ¨çš„Ant Designå›¾æ ‡
**è§£å†³æ–¹æ¡ˆ**: ä½¿ç”¨æ­£ç¡®çš„å›¾æ ‡åç§°
```typescript
// é”™è¯¯
import { TerminalOutlined } from '@ant-design/icons';

// æ­£ç¡®
import { ConsoleSqlOutlined } from '@ant-design/icons';
```

### 5. APIç«¯ç‚¹è·¯å¾„é—®é¢˜
**é—®é¢˜**: å‰ç«¯APIè·¯å¾„ä¸åç«¯ä¸ä¸€è‡´
**è§£å†³æ–¹æ¡ˆ**: ç»Ÿä¸€APIè·¯å¾„é…ç½®
```typescript
// authAPI.ts
export const authAPI = {
  login: (credentials: LoginCredentials) => request.post('/auth/login', credentials),
  logout: () => request.post('/logout'),  // æ³¨æ„ï¼šä¸æ˜¯/auth/logout
  getProfile: () => request.get('/profile'),  // æ³¨æ„ï¼šä¸æ˜¯/auth/profile
  changePassword: (data: ChangePasswordData) => request.post('/change-password', data)
};
```

## å¼€å‘ä¸­åŠŸèƒ½

### 1. SSHç»ˆç«¯ç•Œé¢ ğŸš§
- **WebSSHç»ˆç«¯**: åŸºäºxterm.jsçš„ç»ˆç«¯ç•Œé¢
- **ä¼šè¯ç®¡ç†**: SSHä¼šè¯åˆ—è¡¨å’Œç®¡ç†
- **å®æ—¶è¿æ¥**: WebSocketå®æ—¶é€šä¿¡
- **ç»ˆç«¯é…ç½®**: ç»ˆç«¯ä¸»é¢˜ã€å­—ä½“ã€å¤§å°é…ç½®

### 2. å®¡è®¡æ—¥å¿—ç•Œé¢ ğŸš§
- **æ—¥å¿—æŸ¥çœ‹**: å„ç±»å®¡è®¡æ—¥å¿—çš„æŸ¥çœ‹ç•Œé¢
- **æ—¥å¿—ç­›é€‰**: æŒ‰æ—¶é—´ã€ç”¨æˆ·ã€æ“ä½œç±»å‹ç­›é€‰
- **æ—¥å¿—å¯¼å‡º**: å®¡è®¡æ—¥å¿—å¯¼å‡ºåŠŸèƒ½
- **ç»Ÿè®¡æŠ¥è¡¨**: å®¡è®¡æ•°æ®ç»Ÿè®¡å’Œå›¾è¡¨å±•ç¤º

### 3. æƒé™æ§åˆ¶ç³»ç»Ÿ ğŸš§
- **è·¯ç”±æƒé™**: åŸºäºè§’è‰²çš„è·¯ç”±è®¿é—®æ§åˆ¶
- **ç»„ä»¶æƒé™**: ç»„ä»¶çº§åˆ«çš„æƒé™æ§åˆ¶
- **æŒ‰é’®æƒé™**: æŒ‰é’®çº§åˆ«çš„æƒé™æ§åˆ¶
- **æ•°æ®æƒé™**: æ•°æ®çº§åˆ«çš„æƒé™æ§åˆ¶

## å¼€å‘æŒ‡å—

### 1. ç¯å¢ƒé…ç½®
```bash
# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev

# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build

# è¿è¡Œæµ‹è¯•
npm run test
```

### 2. æ·»åŠ æ–°é¡µé¢
1. åœ¨`src/pages/`ç›®å½•åˆ›å»ºæ–°çš„é¡µé¢ç»„ä»¶
2. åœ¨`src/services/`ç›®å½•æ·»åŠ ç›¸åº”çš„APIæœåŠ¡
3. åœ¨`src/store/`ç›®å½•æ·»åŠ çŠ¶æ€ç®¡ç†slice
4. åœ¨`src/types/`ç›®å½•æ·»åŠ TypeScriptç±»å‹å®šä¹‰
5. åœ¨è·¯ç”±é…ç½®ä¸­æ·»åŠ æ–°è·¯ç”±

### 3. è°ƒè¯•æŠ€å·§
- ä½¿ç”¨Redux DevToolsæŸ¥çœ‹çŠ¶æ€å˜åŒ–
- ä½¿ç”¨React DevToolsè°ƒè¯•ç»„ä»¶
- ä½¿ç”¨Networké¢æ¿è°ƒè¯•APIè¯·æ±‚
- ä½¿ç”¨ConsoleæŸ¥çœ‹é”™è¯¯ä¿¡æ¯

### 4. ä»£ç è§„èŒƒ
- ä½¿ç”¨TypeScriptè¿›è¡Œç±»å‹æ£€æŸ¥
- éµå¾ªESLintä»£ç è§„èŒƒ
- ä½¿ç”¨Prettieræ ¼å¼åŒ–ä»£ç 
- ç¼–å†™å•å…ƒæµ‹è¯•

## éƒ¨ç½²è¯´æ˜

### 1. å¼€å‘ç¯å¢ƒ
```bash
npm run dev
```
è®¿é—®: http://localhost:3000

### 2. ç”Ÿäº§ç¯å¢ƒ
```bash
npm run build
npm run preview
```

### 3. Dockeréƒ¨ç½²
```dockerfile
FROM node:18-alpine
WORKDIR /app
COPY package*.json ./
RUN npm install
COPY . .
RUN npm run build
EXPOSE 3000
CMD ["npm", "run", "preview"]
```

## æ€§èƒ½ä¼˜åŒ–

### 1. ä»£ç åˆ†å‰²
- ä½¿ç”¨React.lazy()è¿›è¡Œç»„ä»¶æ‡’åŠ è½½
- è·¯ç”±çº§åˆ«çš„ä»£ç åˆ†å‰²
- ç¬¬ä¸‰æ–¹åº“çš„æŒ‰éœ€åŠ è½½

### 2. ç¼“å­˜ç­–ç•¥
- Redux Toolkit Query APIç¼“å­˜
- ç»„ä»¶çº§åˆ«çš„ç¼“å­˜
- é™æ€èµ„æºç¼“å­˜

### 3. æ¸²æŸ“ä¼˜åŒ–
- ä½¿ç”¨React.memo()é¿å…ä¸å¿…è¦çš„é‡æ¸²æŸ“
- ä½¿ç”¨useMemo()å’ŒuseCallback()ä¼˜åŒ–è®¡ç®—
- è™šæ‹Ÿæ»šåŠ¨å¤„ç†å¤§é‡æ•°æ®

## æœªæ¥è§„åˆ’

1. **ç§»åŠ¨ç«¯é€‚é…**: å“åº”å¼è®¾è®¡çš„ç§»åŠ¨ç«¯ä¼˜åŒ–
2. **å›½é™…åŒ–**: å¤šè¯­è¨€æ”¯æŒ
3. **ä¸»é¢˜ç³»ç»Ÿ**: å¯é…ç½®çš„ä¸»é¢˜ç³»ç»Ÿ
4. **ç¦»çº¿æ”¯æŒ**: PWAå’Œç¦»çº¿åŠŸèƒ½
5. **å®æ—¶é€šçŸ¥**: WebSocketå®æ—¶é€šçŸ¥ç³»ç»Ÿ 