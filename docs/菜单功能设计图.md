# Bastion 监控系统菜单功能设计图

> 📅 创建时间: 2025-07-19  
> 🎯 基于现有审计结构的功能扩展设计

## 🗂️ 完整菜单结构图

```
🏠 仪表板 (/dashboard)
├── 📊 系统概览 - 整体运行状态
├── 📈 实时监控面板 - 关键指标展示
└── 🔗 快捷入口 - 常用功能直达

👥 用户管理 (/users) [admin]
├── 👤 用户列表 - 用户账号管理
├── 👥 角色管理 - 角色权限配置
└── 🔐 权限分配 - 细粒度权限控制

🖥️ 资产管理 (/assets) [admin, operator]
├── 🖥️ 主机资源 (/assets/hosts)
├── 🗄️ 数据库 (/assets/databases)
└── 📁 分组管理 (/assets/groups) [admin]

🔑 凭证管理 (/credentials) [admin, operator]
├── 🔒 密码凭证 (/credentials/password)
└── 🗝️ 密钥管理 (/credentials/ssh-key)

🌐 远程连接 (/connect) [admin, operator]
├── 🖥️ 主机连接 (/connect/hosts)
├── 🗄️ 数据库连接 (/connect/databases)
└── 🎯 工作台 (/connect/workspace) [新标签页]

📋 审计日志 (/audit) [基础功能 + 新增扩展]
├── 👁️ 在线会话 (/audit/online-sessions) ✅ 已实现
│   ├── 📺 实时监控 - 终端镜像 ✅ 已实现
│   ├── ⚡ 强制下线 - 会话管理 ✅ 已实现
│   ├── 🔍 智能搜索 - 全文搜索 🆕 Phase 1
│   ├── 📱 分屏监控 - 多终端同屏 🆕 Phase 1
│   └── 🚨 实时告警 - 危险操作提醒 🆕 Phase 2
│
├── 🎬 会话录制 (/audit/session-recordings) 🆕 Phase 3
│   ├── 📹 录制管理 - 开始/停止/配置
│   ├── ⏯️ 回放播放 - 精确回放控制
│   ├── 🔍 内容搜索 - 按时间/命令定位
│   └── 📝 注释系统 - 时间戳标记
│
├── 🚨 告警中心 (/audit/alerts) 🆕 Phase 2
│   ├── 📋 告警规则 - 智能规则引擎
│   ├── 📊 告警历史 - 历史告警记录
│   ├── 📧 通知配置 - 邮件/Webhook设置
│   └── 📈 统计分析 - 告警趋势分析
│
├── 📊 行为分析 (/audit/behavior-analytics) 🆕 Phase 4
│   ├── 👤 用户画像 - 行为模式分析
│   ├── 🎯 风险评分 - 实时风险计算
│   ├── 🤖 异常检测 - AI驱动检测
│   └── 📈 合规报告 - 自动化报告生成
│
├── 🖥️ 会话审计 (/audit/session-audit) ✅ 已实现
├── ⌨️ 命令审计 (/audit/command-audit) ✅ 已实现
└── ⚙️ 操作审计 (/audit/operation-audit) ✅ 已实现
```

## 🎨 界面布局设计

### 📊 审计概览页面 (/audit) - 优化版

```
┌─────────────────────────────────────────────────────────────────┐
│  📋 审计日志 > 概览                                  🔔 通知 👤 用户  │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ │
│  │👁️ 在线会话  │ │🚨 智能告警  │ │🎬 会话录制  │ │📊 行为分析  │ │
│  │    🟢 12    │ │    🔴 3     │ │    📹 156   │ │    ⚠️ 5     │ │
│  │   活跃会话   │ │   活跃告警   │ │   录制文件   │ │   风险会话   │ │
│  │ ┌─────────┐ │ │ ┌─────────┐ │ │ ┌─────────┐ │ │ ┌─────────┐ │ │
│  │ │📱分屏监控│ │ │ │📋规则管理│ │ │ │⏯️回放播放│ │ │ │🎯风险评分│ │ │
│  │ │🔍智能搜索│ │ │ │📈趋势分析│ │ │ │🔍内容搜索│ │ │ │🤖AI检测 │ │ │
│  │ └─────────┘ │ │ └─────────┘ │ │ └─────────┘ │ │ └─────────┘ │ │
│  └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘ │
│                                                                 │
│  📈 实时监控趋势                        📊 今日统计概览          │
│  ┌─────────────────────────────┐      ┌─────────────────────┐   │
│  │    会话数量变化图表           │      │ • 总会话: 1,234      │   │
│  │ 25 ┌─┐                      │      │ • 告警数: 23         │   │
│  │ 20 │ │   ┌─┐                │      │ • 录制时长: 45.6h    │   │
│  │ 15 │ │ ┌─┘ │                │      │ • 风险事件: 8        │   │
│  │ 10 └─┘ │   └─┐              │      │ • 在线用户: 67       │   │
│  │  5     │     └──            │      └─────────────────────┘   │
│  │  0 ────┘                    │                                │
│  └─────────────────────────────┘                                │
└─────────────────────────────────────────────────────────────────┘
```

### 👁️ 在线会话监控页面 (/audit/online-sessions) - 增强版

```
┌─────────────────────────────────────────────────────────────────┐
│  📋 审计日志 > 在线会话                    🔍 搜索框  📱 分屏  🔄 刷新 │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  🔍 智能搜索栏                                                   │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │ 🔎 [全局搜索] [用户:admin] [时间:今天] [风险:高] 🏷️ 常用过滤 │ │
│  └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
│  📊 会话列表 (实时更新)                                         │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │用户    │主机      │IP地址     │时长  │状态 │风险│操作       │ │
│  ├─────────────────────────────────────────────────────────────┤ │
│  │admin   │web-01   │10.0.1.10  │02:30│🟢活跃│🔴高│👁️监控 ⚡下线│ │
│  │deploy  │db-02    │10.0.2.20  │01:15│🟢活跃│🟡中│👁️监控 ⚡下线│ │
│  │user01  │app-03   │10.0.3.30  │00:45│🟢活跃│🟢低│👁️监控 ⚡下线│ │
│  └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
│  📱 多屏监控视图 (可拖拽调整布局)                               │
│  ┌──────────────────┐ ┌──────────────────┐                    │
│  │ 🖥️ admin@web-01  │ │ 🖥️ deploy@db-02 │                    │
│  │ [root@web-01 ~]# │ │ [deploy@db-02 ~]│                    │
│  │ $ tail -f app.log│ │ $ mysql -u root  │                    │
│  │ 2025-07-19 INFO  │ │ mysql> show      │                    │
│  │ Starting server  │ │ databases;       │                    │
│  │ ▋                │ │ ▋                │                    │
│  └──────────────────┘ └──────────────────┘                    │
└─────────────────────────────────────────────────────────────────┘
```

### 🚨 告警中心页面 (/audit/alerts) - 全新设计

```
┌─────────────────────────────────────────────────────────────────┐
│  📋 审计日志 > 告警中心                      📋 规则  📊 统计  ⚙️ 配置│
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  🚨 实时告警监控                                                │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │⏰ 09:23:45 🔴 [危险命令] admin 在 web-01 执行 rm -rf /tmp/* │ │
│  │⏰ 09:22:10 🟡 [登录异常] user01 从异地IP 203.0.113.50 登录  │ │
│  │⏰ 09:20:33 🔴 [权限提升] deploy 执行 sudo su - root        │ │
│  └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
│  📊 告警统计面板                                                │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ │
│  │ 🔴 严重告警  │ │ 🟡 警告告警  │ │ 📈 今日趋势  │ │ 🎯 准确率   │ │
│  │     3       │ │     12      │ │    ↗️ +25%  │ │   94.8%    │ │
│  └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘ │
│                                                                 │
│  📋 告警规则管理                                                │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │规则名称        │级别│状态 │触发次数│最后触发    │操作     │ │
│  ├─────────────────────────────────────────────────────────────┤ │
│  │危险命令检测     │🔴高│🟢启用│   156  │5分钟前      │✏️编辑 ❌删除│ │
│  │异地登录检测     │🟡中│🟢启用│    23  │2小时前      │✏️编辑 ❌删除│ │
│  │权限提升监控     │🔴高│🟢启用│    45  │30分钟前     │✏️编辑 ❌删除│ │
│  └─────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
```

## 🔐 权限控制矩阵

### 详细权限映射表

| 功能模块 | 管理员 | 审计员 | 运维员 | 观察者 |
|---------|-------|-------|-------|-------|
| **在线会话监控** | ✅ | ✅ | ✅ | ✅ |
| 实时监控查看 | ✅ | ✅ | ✅ | ✅ |
| 强制下线操作 | ✅ | ✅ | ❌ | ❌ |
| 分屏监控 | ✅ | ✅ | ✅ | ✅ |
| 智能搜索 | ✅ | ✅ | ✅ | ✅ |
| **告警中心** | ✅ | ✅ | 🔶 | ❌ |
| 查看告警 | ✅ | ✅ | ✅ | ❌ |
| 管理规则 | ✅ | ✅ | ❌ | ❌ |
| 配置通知 | ✅ | ✅ | ❌ | ❌ |
| **会话录制** | ✅ | ✅ | 🔶 | 🔶 |
| 查看录制 | ✅ | ✅ | ✅ | ✅ |
| 管理录制 | ✅ | ✅ | ❌ | ❌ |
| 删除录制 | ✅ | ❌ | ❌ | ❌ |
| **行为分析** | ✅ | ✅ | ❌ | ❌ |
| 查看分析 | ✅ | ✅ | ❌ | ❌ |
| 配置模型 | ✅ | ❌ | ❌ | ❌ |
| 生成报告 | ✅ | ✅ | ❌ | ❌ |

> 图例: ✅=完全访问 🔶=受限访问 ❌=无访问权限

## 🎯 快捷操作设计

### ⌨️ 全局快捷键

| 快捷键 | 功能 | 适用页面 |
|-------|------|---------|
| `Ctrl + F` | 打开搜索 | 所有列表页面 |
| `Ctrl + M` | 切换分屏 | 在线会话页面 |
| `Ctrl + N` | 新建监控 | 在线会话页面 |
| `F11` | 全屏切换 | 终端监控页面 |
| `Esc` | 关闭弹窗 | 所有模态框 |
| `Ctrl + R` | 刷新数据 | 所有列表页面 |
| `Ctrl + Shift + A` | 告警中心 | 全局 |
| `Ctrl + Shift + S` | 会话搜索 | 全局 |

### 🔗 快速入口

```typescript
// 顶部导航栏快捷入口
const QuickActions = [
  {
    icon: '👁️',
    title: '在线监控',
    count: 12,
    path: '/audit/online-sessions',
    hotkey: 'Ctrl+Shift+M'
  },
  {
    icon: '🚨', 
    title: '告警中心',
    count: 3,
    status: 'danger',
    path: '/audit/alerts',
    hotkey: 'Ctrl+Shift+A'
  },
  {
    icon: '📹',
    title: '录制管理', 
    count: 156,
    path: '/audit/session-recordings',
    hotkey: 'Ctrl+Shift+R'
  }
];
```

## 📱 响应式设计适配

### 移动端菜单设计

```
📱 移动端导航 (折叠式)
┌─────────────────────┐
│ ☰ Bastion    🔔 👤 │
├─────────────────────┤
│ 🏠 仪表板           │
│ 👁️ 在线监控 (12)    │ ← 重点功能前置
│ 🚨 告警中心 (3)     │ ← 重点功能前置  
│ 📋 审计日志 ›       │
│ 🌐 远程连接 ›       │
│ 🖥️ 资产管理 ›       │
│ 👥 用户管理 ›       │
│ 🔑 凭证管理 ›       │
└─────────────────────┘
```

### 平板端布局

```
📟 平板端布局 (侧边栏 + 主内容)
┌──────┬─────────────────────────────────┐
│ 📋   │ 👁️ 在线会话监控                │
│ 审计 │ ┌─────────────────────────────┐ │
│ ├👁️会话│ │ 搜索: [admin] [今天] [高风险]│ │
│ ├🚨告警│ ├─────────────────────────────┤ │
│ ├📹录制│ │ admin@web-01  🔴高  👁️ ⚡   │ │
│ └📊分析│ │ user01@app-02 🟡中  👁️ ⚡   │ │
│      │ └─────────────────────────────┘ │
│ 🌐   │                                 │
│ 连接 │ 📱 分屏监控 (2x1)               │
│      │ ┌──────────────┬──────────────┐ │
│      │ │admin@web-01  │user01@app-02 │ │
│      │ │$ tail -f log │$ ls -la      │ │
│      │ └──────────────┴──────────────┘ │
└──────┴─────────────────────────────────┘
```

## 🎨 主题和样式规范

### 🎯 色彩方案

```css
/* 主题色彩定义 */
:root {
  /* 主色调 */
  --primary-color: #1890ff;
  --primary-hover: #40a9ff;
  --primary-active: #096dd9;
  
  /* 功能色彩 */
  --success-color: #52c41a;
  --warning-color: #faad14;
  --error-color: #f5222d;
  --info-color: #13c2c2;
  
  /* 风险等级色彩 */
  --risk-critical: #ff4d4f;
  --risk-high: #ff7a45;
  --risk-medium: #ffc53d;
  --risk-low: #73d13d;
  
  /* 状态色彩 */
  --status-online: #52c41a;
  --status-offline: #bfbfbf;
  --status-warning: #faad14;
  --status-error: #f5222d;
}

/* 组件样式规范 */
.monitoring-card {
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  transition: all 0.3s ease;
}

.terminal-container {
  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
  background: #1e1e1e;
  border-radius: 4px;
}

.alert-item {
  border-left: 4px solid var(--error-color);
  padding: 12px 16px;
  margin-bottom: 8px;
}
```

## 📋 总结

### 💡 设计理念

1. **功能归类清晰**: 监控功能统一归属于审计模块，语义明确
2. **权限控制精细**: 基于角色和功能的双重权限控制
3. **用户体验优先**: 快捷键、搜索、分屏等提升操作效率
4. **渐进式增强**: 在现有基础上逐步扩展，不影响现有功能
5. **响应式设计**: 支持桌面、平板、移动端全平台访问

### 🎯 核心优势

- ✅ **保持现有结构**: 用户学习成本最低
- ✅ **功能模块化**: 每个功能相对独立，便于开发维护  
- ✅ **权限体系完善**: 支持细粒度的权限控制
- ✅ **扩展性良好**: 为未来功能预留充足空间
- ✅ **用户体验佳**: 直观的界面和便捷的操作

### 🚀 实施建议

建议按照 **Phase 1 → Phase 2 → Phase 3 → Phase 4** 的顺序逐步实施，每个阶段完成后进行用户测试和反馈收集，确保功能满足实际需求。

---

*📝 本文档与《监控系统优化方案.md》配套使用，提供直观的界面设计参考*