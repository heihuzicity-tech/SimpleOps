# 新对话快速启动提示词 v2.0

## 项目概述

我正在开发一个企业级**运维堡垒机系统 (Bastion)**，该系统已完成**95%**的开发工作，目前处于**稳定运行阶段**。这是一个功能完整的堡垒机系统，已具备生产环境部署能力。

## 技术架构

### 后端技术栈
- **框架**: Go 1.21 + Gin + GORM + WebSocket
- **数据库**: MySQL 8.0 + Redis
- **认证**: JWT + 基于角色的权限控制(RBAC)
- **特性**: RESTful API + WebSocket双向通信 + 完整审计日志

### 前端技术栈  
- **框架**: React 18 + TypeScript + Ant Design 5
- **状态管理**: Redux Toolkit
- **终端**: xterm.js + WebSocket实时通信
- **特性**: 响应式设计 + 现代化UI + 实时SSH终端

## 系统功能状态

### ✅ 已完成功能 (100%)
1. **用户认证与权限管理**
   - JWT登录认证
   - 基于角色的权限控制
   - 用户管理界面

2. **资产管理系统**
   - 服务器资产管理
   - 凭证管理
   - 资产-凭证关联

3. **WebSSH终端** (核心功能)
   - 浏览器内SSH连接
   - xterm.js终端模拟器
   - WebSocket双向通信
   - 会话管理和监控
   - 终端大小自适应和全屏模式

4. **审计日志系统**
   - 登录日志记录
   - 操作日志追踪
   - 会话记录和命令审计
   - 完整的审计数据链

5. **完整前端界面**
   - 现代化Dashboard
   - 用户/资产/凭证管理页面
   - SSH会话管理页面
   - 响应式设计

## 系统结构

```
bastion/
├── backend/           # Go后端服务 (100%)
│   ├── controllers/   # API控制器
│   ├── services/      # 业务逻辑层
│   ├── models/        # 数据模型
│   ├── middleware/    # 中间件(认证/权限/审计)
│   └── routers/       # 路由配置
├── frontend/          # React前端 (95%)
│   ├── src/components/ssh/  # SSH终端组件
│   ├── src/pages/     # 页面组件
│   ├── src/services/  # API服务层
│   └── src/store/     # Redux状态管理
├── docs/              # 完整项目文档
└── manage.sh          # 服务管理脚本
```

## 核心API端点

### 认证API
- `POST /api/v1/auth/login` - 用户登录
- `POST /api/v1/auth/refresh` - Token刷新
- `GET /api/v1/profile` - 获取用户信息

### SSH会话API  
- `POST /api/v1/ssh/sessions` - 创建SSH会话
- `GET /api/v1/ssh/sessions` - 获取会话列表
- `DELETE /api/v1/ssh/sessions/{id}` - 关闭会话
- `WebSocket: /api/v1/ws/ssh/sessions/{id}/ws` - 终端通信

### 管理API
- `/api/v1/users/*` - 用户管理
- `/api/v1/assets/*` - 资产管理  
- `/api/v1/credentials/*` - 凭证管理
- `/api/v1/audit/*` - 审计日志

## 运行环境

### 服务状态
- **后端服务**: http://localhost:8080 (Go Gin)
- **前端服务**: http://localhost:3000 (React)
- **数据库**: MySQL 8.0 + Redis
- **管理脚本**: `./manage.sh [start|stop|restart|status|logs]`

### 默认账户
- **管理员**: admin / admin123
- **权限**: 完整系统管理权限

## 最近完成的重要工作

### 技术问题修复 (已解决)
1. **前端组件无限重渲染** - 修复React useCallback依赖问题
2. **SSH管道"Stdout already set"错误** - 重构SSH连接管理架构  
3. **WebSocket路由重复** - 分离REST API和WebSocket路由
4. **服务管理优化** - 创建便捷的服务管理脚本

### 文档完善
- ✅ 故障排查文档 (技术面试案例)
- ✅ API使用指南更新
- ✅ 前端开发指南更新  
- ✅ 任务进度跟踪完成

## 项目特点

### 企业级特性
- **高可用架构**: 支持并发访问和负载均衡
- **安全设计**: JWT认证 + RBAC权限 + 操作审计
- **实时通信**: WebSocket支持实时SSH终端
- **完整审计**: 全链路操作日志和会话记录

### 技术亮点  
- **现代化技术栈**: Go + React + TypeScript
- **API优先设计**: RESTful API + 完整文档
- **类型安全**: 前后端TypeScript类型定义
- **故障恢复**: 完整的错误处理和重连机制

## 当前状态说明

系统已达到**95%完成度**，**所有核心功能均已实现并验证通过**，包括：
- ✅ 用户可以成功登录系统
- ✅ 可以管理服务器资产和登录凭证
- ✅ 可以通过浏览器创建SSH会话并操作远程服务器
- ✅ 所有操作都有完整的审计日志记录  
- ✅ 前后端服务稳定运行

## 协作说明

### 如果需要协助
1. **代码开发**: 系统功能基本完整，主要是优化和新功能扩展
2. **问题排查**: 可以参考已有的故障排查文档和经验
3. **功能扩展**: 可以基于现有架构添加新功能模块
4. **部署运维**: 可以协助生产环境部署和优化

### 文档参考
- `docs/API使用指南.md` - 完整API文档
- `docs/前端开发指南.md` - 前端技术文档
- `docs/WebSSH终端故障排查文档.md` - 技术故障案例
- `docs/任务进度跟踪.md` - 项目进度和完成情况

---

**项目版本**: v0.9.0-dev  
**最后更新**: 2025-07-14  
**状态**: 生产就绪 (Production Ready) 🚀